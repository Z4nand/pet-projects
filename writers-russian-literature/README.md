# Русская литература — классификация авторов с использованием эмбеддингов

## Описание проекта

В этом проекте реализована модель классификации текстов пяти русских писателей с использованием предобученных эмбеддингов **Navec (Наташа)**.  
Цель — обучить модель отличать произведения выбранных авторов с точностью не ниже 70% на тесте.

---

## Авторы и датасет

Использованы тексты пяти авторов с наибольшим объемом данных:

- Достоевский (Dostoevsky)  
- Толстой (Tolstoy)  
- Тургенев (Turgenev)  
- Чехов (Chekhov)  
- Горький (Gorky)  

Датасет скачивается из [Yandex Cloud](https://storage.yandexcloud.net/academy.ai/russian_literature.zip) и распаковывается с переименованием файлов.

---

## Этапы решения

### 1. Подготовка данных

- Скачивание и распаковка датасета  
- Выбор пяти авторов с наибольшим объемом текстов  
- Предобработка текста: очистка, лемматизация с помощью `pymorphy3`  
- Токенизация с использованием токенизатора `razdel`

### 2. Формирование выборок

- Ограничение длины текста для каждого автора (40 000 токенов)  
- Формирование обучающей, валидационной и тестовой выборок в соотношении 80% / 10% / 10%  
- Балансировка данных по классам

### 3. Работа с эмбеддингами

- Загрузка предобученных весов Navec  
- Создание матрицы эмбеддингов для слов из словаря токенизатора  
- Заморозка слоя эмбеддинга на первом этапе обучения

### 4. Построение и обучение модели

- Использование сверточной нейронной сети (Conv1D)  
- Первый этап: обучение с замороженным эмбеддингом  
- Второй этап: fine-tuning с разморозкой эмбеддинга и сниженной скоростью обучения

### 5. Оценка результатов

- Оценка модели на тестовой выборке  
- Вывод точности и построение матрицы ошибок  
- Визуализация кривых обучения (accuracy и loss)

---

## Установка

1. Датасет

```
https://storage.yandexcloud.net/academy.ai/russian_literature.zip
или 
https://www.kaggle.com/datasets/d0rj3228/russian-literature
```
2. Natasha-navec

```
https://storage.yandexcloud.net/natasha-navec/packs/navec_hudlit_v1_12B_500K_300d_100q.tar
```